import{A as h}from"./consts.DsKB0OsF.js";import"./hoisted.DCkWY5T-.js";console.log("Contact page");function y(){const{form:t,radios:a,reason:s,errorInputs:n}=p();a.forEach(o=>{o.addEventListener("click",e=>{a.forEach(i=>i.closest("label").removeAttribute("data-selected")),e.target.closest("label").setAttribute("data-selected","selected"),f()})}),n?.forEach(o=>{const e=o,r=e.closest("label").querySelector(".error");e.addEventListener("input",()=>{console.log("Validating",e.name,e.validity),e.validity.valid?r.innerHTML="":e.validity.valueMissing?r.innerHTML=e.dataset.errorRequired??"שדה חובה":e.validity.tooLong?r.innerHTML=e.dataset.errorMax??`חייב להכיל עד ${e.maxLength} תווים`:e.validity.tooShort?r.innerHTML=e.dataset.errorMin??`חייב להכיל לפחות ${e.minLength} תווים`:e.validity.typeMismatch&&(e.type==="email"?r.innerHTML="כתובת אימייל לא תקינה":r.innerHTML="שדה לא תקין"),f()})}),s.addEventListener("change",f),t?.addEventListener("submit",L)}function f(){const{button:t,method:a,reason:s,errorInputs:n}=p(),o=[...n].every(e=>e.validity.valid)&&a.value?.length&&s.value?.length;console.log("All valid",o,{method:a.value,reason:s.value}),t.disabled=!o}function p(){const t=document.querySelector("form"),a=t.querySelector("fieldset"),s=t.querySelector(".form-error"),n=t.elements,o=n.namedItem("name"),e=n.namedItem("email"),r=n.namedItem("phone"),i=n.namedItem("method"),c=n.namedItem("reason"),l=n.namedItem("description"),m=t.querySelector("button"),u=t.querySelectorAll("input[type=radio]"),v=t?.querySelectorAll("[data-error]"),d=document.getElementById("form-done");return{form:t,error:s,fieldset:a,name:o,email:e,phone:r,method:i,reason:c,description:l,button:m,radios:u,errorInputs:v,done:d}}async function L(t){const{form:a,name:s,error:n,fieldset:o,email:e,phone:r,method:i,reason:c,button:l,description:m,done:u}=p(),v=l.innerHTML;try{if(t.preventDefault(),o.disabled=!0,n.innerHTML="",l.innerHTML="שולח...",!(await fetch(`${h}/contact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s.value,email:e.value,שם:s.value,אימייל:e.value,טלפון:r.value,"דרך יצירת קשר":i.value,"סיבת הפנייה":c.value,"תיאור הפנייה":m.value})})).ok)throw new Error("שגיאה בשליחה");a.reset(),a.innerHTML=u.innerHTML}catch(d){o.disabled=!1,n.innerHTML=d.message,l.innerHTML=v,console.error(d)}return!1}document.addEventListener("DOMContentLoaded",y);document.addEventListener("astro:after-swap",y);
