import{A as L}from"./consts.DkG-I2j4.js";import"./hoisted.D4LgPPZp.js";document.addEventListener("astro:page-load",y);function y(){const{form:n,radios:s,reason:a,errorInputs:t}=h();s.forEach(o=>{o.addEventListener("click",e=>{s.forEach(i=>i.closest("label").removeAttribute("data-selected")),e.target.closest("label").setAttribute("data-selected","selected"),p()})}),t?.forEach(o=>{const e=o,r=e.closest("label").querySelector(".error");e.addEventListener("input",()=>{e.validity.valid?(r.innerHTML="",r.classList.add("hidden")):(e.validity.valueMissing?r.innerHTML=e.dataset.errorRequired??"שדה חובה":e.validity.tooLong?r.innerHTML=e.dataset.errorMax??`חייב להכיל עד ${e.maxLength} תווים`:e.validity.tooShort?r.innerHTML=e.dataset.errorMin??`חייב להכיל לפחות ${e.minLength} תווים`:e.validity.typeMismatch&&(e.type==="email"?r.innerHTML="כתובת אימייל לא תקינה":r.innerHTML="שדה לא תקין"),r.classList.remove("hidden")),p()})}),a.addEventListener("change",p),n?.addEventListener("submit",M)}function p(){const{button:n,method:s,reason:a,errorInputs:t}=h(),o=[...t].every(e=>e.validity.valid)&&s.value?.length&&a.value?.length;n.disabled=!o}function h(){const n=document.querySelector("form"),s=n.querySelector("fieldset"),a=n.querySelector(".form-error"),t=n.elements,o=t.namedItem("name"),e=t.namedItem("email"),r=t.namedItem("phone"),i=t.namedItem("method"),c=t.namedItem("reason"),l=t.namedItem("description"),m=n.querySelector("button"),u=n.querySelectorAll("input[type=radio]"),f=n?.querySelectorAll("[data-error]"),v=t.namedItem("cf-turnstile-response"),d=document.getElementById("form-done");return{form:n,error:a,fieldset:s,name:o,email:e,phone:r,method:i,reason:c,description:l,button:m,radios:u,errorInputs:f,turnstileResponse:v,done:d}}async function M(n){const{form:s,name:a,error:t,fieldset:o,email:e,phone:r,method:i,reason:c,button:l,description:m,done:u,turnstileResponse:f}=h(),v=l.innerHTML;try{if(n.preventDefault(),o.disabled=!0,t.innerHTML="",t.classList.add("hidden"),l.innerHTML="שולח...",!(await fetch(`${L}/contact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sender:{name:a.value,email:e.value},details:[["שם",a.value],["אימייל",e.value],["טלפון",r.value],["דרך יצירת קשר",i.value],["סיבת הפנייה",c.value],["תיאור הפנייה",m.value]],captchaToken:f.value})})).ok)throw new Error("שגיאה בשליחה");s.reset(),s.innerHTML=u.innerHTML}catch(d){o.disabled=!1,t.innerHTML=d.message,t.classList.remove("hidden"),l.innerHTML=v,console.error(d)}return!1}
